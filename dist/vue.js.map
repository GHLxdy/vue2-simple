{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\r\n  return typeof val === \"function\";\r\n}\r\n\r\nexport function isObject(val) {\r\n  return typeof val === \"object\" && val !== null;\r\n}\r\n","import { isObject } from \"../utils\";\r\n\r\n// 检测数据的变化\r\nclass Observe {\r\n  constructor(data) {\r\n    // 对象中的所有属性 进行数据劫持\r\n    this.walk(data);\r\n  }\r\n\r\n  walk(data) {\r\n    Object.keys(data).forEach(key => {\r\n      defineReactive(data, key, data[key]);\r\n    });\r\n  }\r\n}\r\n\r\n// vue2 会将对象进行遍历 将每个属性 用defineProperty 重新定义 =》 性能差\r\nfunction defineReactive(data, key, value) {\r\n  observe(value); // 本身用户默认值是对象嵌套对象， 需进行递归处理\r\n  Object.defineProperty(data, key, {\r\n    get() {\r\n      return value;\r\n    },\r\n    set(newV) {\r\n      observe(newV); // 如果用户赋值一个新对象，需要将这个对象进行劫持\r\n      value = newV;\r\n    }\r\n  });\r\n}\r\n\r\nexport function observe(data) {\r\n  // 如果是对象才观测\r\n  // 默认最外层的data必须是一个对象\r\n  if (!isObject(data)) {\r\n    return;\r\n  }\r\n\r\n  return new Observe(data);\r\n}\r\n","import { observe } from \"./observe/index\";\r\nimport { isFunction } from \"./utils\";\r\n\r\n/**\r\n * 状态初始化\r\n * @param {*} vm\r\n */\r\nexport function initSate(vm) {\r\n  const opts = vm.$options;\r\n  // if (opts.props) {\r\n  //   initProps()\r\n  // }\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n  // if (opts.computed) {\r\n  //   initComputed()\r\n  // }\r\n  // if (opts.watch) {\r\n  //   initWatch()\r\n  // }\r\n}\r\n\r\nfunction proxy(vm, source, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[source][key];\r\n    },\r\n    set(newValue) {\r\n      vm[source][key] = newValue;\r\n    }\r\n  });\r\n}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data;\r\n  // vue2中会将data中所有的数据 进行数据劫持 Object.defineProperty\r\n\r\n  data = vm._data = isFunction(data) ? data.call(vm) : data;\r\n\r\n  for (let key in data) {\r\n    proxy(vm, \"_data\", key);\r\n  }\r\n\r\n  observe(data);\r\n}\r\n","import { initSate } from \"./state\";\r\n\r\n// 在Vue的基础上做一次混合操作\r\nexport function initMixin(Vue) {\r\n  Vue.prototype._init = function (options) {\r\n    const vm = this;\r\n    vm.$options = options;\r\n\r\n    // 对数据进行初始化\r\n    initSate(vm);\r\n  };\r\n}\r\n","import { initMixin } from \"./init\";\r\n\r\nexport default function Vue(options) {\r\n  this._init(options);\r\n}\r\n// 扩展原型\r\ninitMixin(Vue);\r\n"],"names":[],"mappings":"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"}